from KatilMusic import app 
import asyncio
import random
from pyrogram import Client, filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.errors import UserNotParticipant
from pyrogram.types import ChatPermissions

spam_chats = []

EMOJI = [ "??????????",
          "???å∏???ç¨??",
          "???å∑?åπ?å∫??",
          "?å∏?åø?íÆ?å±?åµ",
          "?§Ô????????ñ§",
          "??????????",
          "?å∏???å∫?åπ??",
          "???¶™???ç≤??",
          "?????????å∂Ô∏?,
          "???•§?????ç∑",
          "?ç¨?ç≠?????ç°",
          "?ç®???ç∫?ï??,
          "?•™?•ß?ç¶?ç•??",
          "???ï?π?∑ü•?,
          "?ïüßÉ?©?¶??,
          "???åæ?íÆ???åø",
          "?å®Ô∏è?•Ô??àÔ??å©Ô∏è?ßÔ?",
          "?å∑?èµÔ∏è?∏?∫??,
          "?íÆ?åº?åª????",
          "???¶∏?¶π???ë∏",
          "???????åΩ?•¶",
          "?ê∑?êπ?ê≠?ê®?êª?ç‚?Ô∏?,
          "???????????ç‚?",
          "?åº?å≥?å≤?å¥?åµ",
          "?•©????????",
          "?ç¥?çΩÔ∏è?™?∂ü•?,
          "???è∞?è©?©Ô??è©",
          "??????????",
          "?™¥?åµ?å¥?å≥?å≤",
          "??????????",
          "??????Ô∏èü¶§ü¶?,
          "?¶§?¶©??????",
          "?ê¨?¶≠?????ê≥",
          "???????ê°??",
          "?¶©???????¶™",
          "?ê¶???ï∑Ô∏è?∏Ô???",
          "?•™?ç∞?•ß?ç®?ç®",
          " ?•¨??????",
        ]

TAGMES = [ " **??…¢·¥è·?·¥?…¥…™…¢?·¥???** ",
           " **??·¥Ñ ú·?·¥?·¥Ñ ú·?·¥?s·¥?·¥ä·? ??** ",
           " **??·¥ò ú·?…¥·¥??·¥Ä·¥ã ?·¥ã·?? s·¥?·¥ä·?, …¥·¥Ä?…™ ·¥õ·? ??·¥è·?·¥?·¥Ä·¥Ä ·¥ä·??·¥á…¢·?..?ëª** ",
           " **??·¥Ä·¥°·?·¥??·¥Ä?·¥?s·¥è…¥·? ·¥Ö…™…?·¥ç·?…™…¥ ·¥ã·?? ?·¥á…¥·? ·¥Ä??…™ s·¥?·¥ä·?·¥?.?? ?•≤** ",
           " **??·¥ç·?·¥ç·?? ·¥Ö·?·¥ã ú·? ?·¥?·¥Ä·¥ò…¥·? …¢? s·¥??·¥Ä·¥Ä·¥?·¥ã Ä ??·¥Ä ? ?·¥Ä·¥ä·?…™ ·¥ç·? …¢?·¥ús ·¥ã·??, s·¥?…¥·¥Ä?…™ ?·¥Ä?·¥Ä ??** ",
           " **??·¥ò·?·¥ò·? ?·¥?·¥Ö·?·¥ã ú·? ·¥Ä·¥ò…¥·? ?·¥á·?·¥?·¥ã·? ?·¥Ä·¥Ä·¥???·¥Ä? ·¥ò ú·?…¥·¥?·¥Ñ ú·??·¥Ä ??·¥Ä ?·¥Ä…™ ?§≠** ",
           " **??·¥ä·?…¥·¥?·¥Ä·¥Ä·¥??·¥Ä·¥Ä·¥?·¥ã·? s·¥Ñ·?…¥·¥??…¥·¥Ä ?·¥?.?? ??** ",
           " **??…¢…¥ s·¥?·¥õ·?.. ??** ",
           " **??…¢·¥è·?·¥?…¥…™…¢?·¥?s·¥°·?·¥á·? ·¥Ö Ä·¥á·?·¥?·¥õ·?·¥ã·? ·¥Ñ·??·¥?.?? ??* ",
           " **???·¥Ä·¥Ä·¥???·¥ú·? ?·¥?…¢?…™ ?·¥Ä…™ s·¥?·¥ä·?·¥? …¢…¥..?? ??** ",
           " **??·¥ç·?·¥ç·?? ·¥Ö·?·¥ã ú·? 11 ?·¥Ä·¥ä…¥·? ·¥°·??·¥??·¥Ä…™ ?·¥?·¥Ä??…™ ·¥õ·?·¥?·¥ò ú·?…¥·¥?·¥Ñ ú·??·¥Ä ??·¥Ä …¥·¥Ä?…™ s·¥?…¥·¥Ä?…™ ??·¥Ä ?ï¶** ",
           " **??·¥ã·?? s·¥ú ô ú·? s·¥Ñ ú·?·¥è ?…¥·¥Ä?…™ ·¥ä·?…¥·¥Ä ·¥ã è·?, ·¥ä·? ·¥Ä??…™ ·¥õ·?·¥?·¥ä·?…¢ ??·¥??·¥??è´** ",
           " **???·¥Ä?·¥? …¢·¥è·?·¥?…¥…™…¢?·¥?s·¥?·¥õ·?..?? ??** ",
           " **??·¥Ä·¥Ä·¥???·¥ú·? ·¥õ ú·?…¥·¥??·¥Ä…™, ·¥Ä·¥Ä?·¥Ä·¥?s·¥?·¥ä·??·¥Ö…?s·¥?·¥ä·?·¥õ…??·¥è·?…¥ ?åº** ",
           " **??·¥ä·?…¥·¥á·?·¥Ä…¥, …¢·¥è·?·¥?…¥…™…¢?·¥??å∑** ",
           " **??·¥ç·? ·¥ä·? ?·¥Ä?…™ s·¥è…¥·?, …¢…¥ s·¥?·¥õ·? ?èµÔ∏?* ",
           " **???·¥á ü ü·? ·¥ä…?…¥·¥Ä·¥ç·?s·¥õ·?, …¢·¥è·?·¥?…¥…™…¢?·¥???** ",
           " **???·¥á ? ?·¥Ä?? ·¥ã·???..? s·¥è…¥·? …¥·¥Ä?…™ ?·¥Ä…™ ·¥ã è·? ?ÉÔ?** ",
           " **??…¢·¥è·?·¥?…¥…™…¢?·¥?·¥ä…? ??·¥ú·? ?·¥Ä·¥Ä·¥??·¥?…¢?…™..? ??* ",
           " **??·¥ç·? ·¥ä·? ?·¥Ä?…™ ?·¥è…¥·?, …™ ·¥ç·?·¥Ä…¥ s·¥è…¥·? …¢·¥è·?·¥?…¥…™…¢?·¥?·¥ä…???** ",
           " **??·¥ç·?·¥Ñ ú ú·??…™ ·¥ã·? ·¥ã·??·¥õ·? ?·¥Ä…™ ?…™s?, …¢·¥è·?·¥?…¥…™…¢?·¥?·¥Ö·?·¥Ä? ·¥ç·?·¥?·¥ã Ä…¥·¥Ä ·¥ç…™ss, ·¥ä·? ??…™ s·¥è…¥·? ??** ",
           " **??…¢·¥è·?·¥?…¥…™…¢?·¥???…™…¢?·¥õ“ì·??? …¥…™…¢?·¥??§≠** ",
           " **??·¥õ ú·? …¥…™…¢?·¥??·¥Äs ?·¥Ä??·¥á…? ·¥õ ú·? ·¥Ö·?? …™s ·¥Ö·?…¥·¥?, ·¥õ ú·? ·¥ç·?·¥è…??·¥Äs ·¥õ·?·¥ã·?…¥ ·¥õ ú·? ·¥ò ü·?·¥Ñ·? ·¥è“?·¥õ ú·? s·¥ú…?.. ??** ",
           " **??·¥ç·?? ·¥Ä?? ?·¥è·?? ·¥Ö Ä·¥á·?·¥çs ·¥Ñ·?·¥ç·? ·¥õ Ä·¥ú·? ?§Ô?** ",
           " **??…¢·¥è·?·¥?…¥…™…¢?·¥?s·¥ò Ä…™…¥·¥ã ü·?s s·¥°·?·¥á·? ·¥Ö Ä·¥á·?·¥???** ",
           " **??…¢·¥è·?·¥?…¥…™…¢?·¥? …¥…™…¥·¥?·¥Ä·¥Ä ??…™ ?·¥Ä…™ ?•±** ",
           " **??·¥Ö·?·¥Ä? ??…™·¥á…¥·? …¢·¥è·?·¥?…¥…™…¢?·¥??í§** ",
           " **???·¥Ä?? ·¥Ä·¥Ä·¥??·¥Ä·¥Ä·¥?·¥ã·? s·¥Ñ·?…¥·¥??…¥·¥Ä ?·¥??•∞** ",
           " **??…™·¥õ…¥…??·¥Ä·¥Ä·¥?·¥ç·? ·¥ä·?…¢ ·¥ã·?? ·¥ã è·? ·¥ã·?? ??·¥??·¥?s·¥è…¥·? …¥·¥Ä?…™ ?·¥Ä…™ ·¥ã è·? ??** ",
           " **??·¥Ñ ü·?s·¥??·¥è·?? ·¥á è·?s s…¥·¥ú…¢…¢ ü·? ·¥ú·? ·¥õ…™…¢ ú·?,, ·¥Ä…¥·¥??·¥á·?·¥á·??·¥á Ä ·¥õ ú·?·¥?·¥Ä…¥…¢·¥á üs, ·¥°…™ ü ?·¥°·?·¥õ·?? ·¥è·?·¥á Ä ?·¥è·? ·¥õ·?…¥…™…¢?·¥?.. ?í´** ",
           ]

VC_TAG = [ "**??…¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢, ·¥ã·?s·¥??·¥??ê±**",
         "**??…¢·¥? s·¥ú ô ú·? ?·¥?…¢?…™ ·¥ú·??…¥·¥Ä …¥·¥Ä?…™ ?·¥Ä…™ ·¥ã è·? ?å§Ô∏?*",
         "**??…¢·¥??·¥Ä??, ·¥Ñ ú·?…™ ·¥ò…??·¥???*",
         "**??·¥ä·??·¥Ö…?·¥ú·??·¥? s·¥Ñ ú·?·¥è ?…¥·¥Ä?…™ ·¥ä·?…¥·¥Ä ·¥ã è·? ?è´**",
         "**??…¢·¥? ·¥Ñ ú·?·¥?·¥Ñ ú·?·¥??…™s·¥õ·?? s·¥?·¥ú·??·¥?·¥† Ä…¥·¥Ä ·¥ò·?…¥…™ ·¥Ö·?? ·¥Ö·?…¥…¢…™ ??**",
         "**???·¥Ä?? ·¥ú·??·¥?·¥Ä·¥ú Ä ·¥ä·??·¥Ö…???·¥ás? ?·¥?·¥ä·?·¥? …¥·¥Äs·¥õ·? ?·¥á·?·¥Ö ??·¥Ä…™ ??**",
         "**??·¥è“ì“ì…™·?·¥?…¥·¥Ä?…™ ·¥ä·?…¥·¥Ä ·¥ã è·? ·¥ä…?·¥Ä·¥Ä·¥? ·¥Ä??…™ ·¥õ·?·¥?·¥ú·??·¥?…¥·¥Ä?…™ ?è£**",
         "**??…¢·¥?·¥Ö·?s·¥? ·¥Ñ·???·¥á·?/·¥õ·?·¥Ä ·¥ã è·? ?·¥è…¢·? ?ï??*",
         "**???·¥Ä?? 8 ?·¥Ä·¥ä…¥·? ·¥°·??·¥??·¥Ä…™, ·¥Ä·¥ú Ä ·¥õ·?·¥?·¥Ä??…™ ·¥õ·? ·¥ú·??·¥?…¥·¥Ä?…™ ??**",
         "**??·¥ã ú·?·¥ç ô ú·?·¥Ä?·¥Ä…¥ ·¥ã…?·¥Ä·¥ú ü·?·¥?·¥ú·?? ·¥ä·?·¥Ä... ?ÉÔ?**",
         "**??…¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢ ?·¥Ä·¥†·? ·¥Ä …¥…™·¥Ñ·? ·¥Ö·??... ??**",
         "**??…¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢, ?·¥Ä·¥†·? ·¥Ä …¢·¥è·?·¥?·¥Ö·??... ?™¥**",
         "**??…¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢, ?·¥è·¥° ·¥Ä?·¥??·¥è·? ?·¥Ä?? ??**",
         "**??·¥ç·?·¥ç·?? ·¥Ö·?·¥ã ú·? ?·¥?…¥·¥Ä?·¥Ä?·¥?·¥Ä??…™ ·¥õ·?·¥?s·¥???·¥Ä ?·¥Ä…™... ?òµ?ç??*",
         "**???·¥Ä·¥Ä·¥???·¥Ä? ?·¥Ä?·¥?s·¥è…¥·? ·¥ã Ä ??·¥?·¥õ ú·? ·¥ã è·?, ·¥ä·? ·¥Ä??…™ ·¥õ·? s·¥???·¥??·¥?·¥ú·??…¥·¥Ä …¥·¥Ä?…™ ?·¥Ä…™ ·¥ã è·?... ??**",
         "**???·¥Ä?·¥?…¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢ ·¥ú·?? ·¥ä·?·¥?·¥Ä·¥ú Ä …¢?·¥è·?·¥?·¥ç·? s·¥Ä? ??…™·¥á…¥·?s ·¥ã·? …¢·¥?·¥°…™s? ·¥ã Ä·¥?.. ??**",
         "**??·¥ò·?·¥ò·? ?·¥?·¥Ä??…™ ·¥õ·?·¥?·¥ú·?? …¥·¥Ä?…™, s·¥Ñ ú·?·¥è ?·¥ã·? ·¥õ…™·?·¥?…¥…™·¥ã·??·¥õ·? ·¥ä·? ??·¥Ä ?·¥Ä…™... ?•≤**",
         "**??·¥ä·?…¥·¥á·?·¥Ä…¥ …¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢, ·¥ã è·? ·¥ã Ä ??·¥??·¥?... ??**",
         "**??…¢·¥??·¥á·?s·¥õ…™·?, ??·¥á·?·¥ã“ì·?s·¥??·¥ú·? ·¥ã è·?... ?ç≥**",
        ]


@app.on_message(filters.command(["gntag", "tagmember" ], prefixes=["/", "@", "#"]))
async def mentionall(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("‡π?·¥õ ú…™s ·¥Ñ·?·¥ç·?·¥Ä…¥·¥?·¥è…¥ ü ??·¥è Ä …¢?·¥è·?·¥òs.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("‡π??·¥è·? ·¥Ä?·¥?…¥·¥è·? ·¥Ä·¥Ö·?…™…¥ ?·¥Ä??, ·¥è…¥ ü ?·¥Ä·¥Ö·?…™…¥s ·¥Ñ·?…¥ ·¥õ·?…¢ ·¥ç·?·¥ç ô·??s. ")

    if message.reply_to_message and message.text:
        return await message.reply("/tagall …¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢ ·¥õ è·?·¥??…™·¥ã·? ·¥õ ú…™s / ?·¥á·??? ·¥Ä…¥? ·¥ç·?ss·¥Ä…¢·¥?…¥·¥áx·¥?·¥õ…™·?·¥??·¥è·? ·¥õ·?…¢…¢…™…¥…¢...")
    elif message.text:
        mode = "text_on_cmd"
        msg = message.text
    elif message.reply_to_message:
        mode = "text_on_reply"
        msg = message.reply_to_message
        if not msg:
            return await message.reply("/tagall …¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢ ·¥õ è·?·¥??…™·¥ã·? ·¥õ ú…™s / ?·¥á·??? ·¥Ä…¥? ·¥ç·?ss·¥Ä…¢·¥?…¥·¥áx·¥?·¥õ…™·?·¥??·¥è·? ·¥õ·?…¢…¢…™…¥…¢...")
    else:
        return await message.reply("/tagall …¢·¥è·?·¥?·¥ç·??…¥…™…¥…¢ ·¥õ è·?·¥??…™·¥ã·? ·¥õ ú…™s / ?·¥á·??? ·¥Ä…¥? ·¥ç·?ss·¥Ä…¢·¥?…¥·¥áx·¥?·¥õ…™·?·¥??·¥è·? ·¥õ·?…¢…¢…™…¥…¢...")
    if chat_id in spam_chats:
        return await message.reply("‡π?·¥ò ü·?·¥Äs·¥?·¥Ä·¥??…™?s·¥?s·¥õ·?·¥??·¥ú…¥…¥…™…¥…?·¥ç·?…¥·¥õ…™·?…¥ ·¥ò Ä·¥è·?·¥áss...")
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += "<a href='tg://user?id={}'>{}</a>".format(usr.user.id, usr.user.first_name)

        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(TAGMES)}"
                await client.send_message(chat_id, txt)
            elif mode == "text_on_reply":
                await msg.reply(f"[{random.choice(EMOJI)}](tg://user?id={usr.user.id})")
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass


@app.on_message(filters.command(["gmtag"], prefixes=["/", "@", "#"]))
async def mention_allvc(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("‡π?·¥õ ú…™s ·¥Ñ·?·¥ç·?·¥Ä…¥·¥?·¥è…¥ ü ??·¥è Ä …¢?·¥è·?·¥òs.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("‡π??·¥è·? ·¥Ä?·¥?…¥·¥è·? ·¥Ä·¥Ö·?…™…¥ ?·¥Ä??, ·¥è…¥ ü ?·¥Ä·¥Ö·?…™…¥s ·¥Ñ·?…¥ ·¥õ·?…¢ ·¥ç·?·¥ç ô·??s. ")
    if chat_id in spam_chats:
        return await message.reply("‡π?·¥ò ü·?·¥Äs·¥?·¥Ä·¥??…™?s·¥?s·¥õ·?·¥??·¥ú…¥…¥…™…¥…?·¥ç·?…¥·¥õ…™·?…¥ ·¥ò Ä·¥è·?·¥áss...")
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += "<a href='tg://user?id={}'>{}</a>".format(usr.user.id, usr.user.first_name)

        if usrnum == 1:
            txt = f"{usrtxt} {random.choice(VC_TAG)}"
            await client.send_message(chat_id, txt)
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass



@app.on_message(filters.command(["gmstop", "gnstop", "cancle"]))
async def cancel_spam(client, message):
    if not message.chat.id in spam_chats:
        return await message.reply("‡π?·¥Ñ·???·¥á…¥·??? …™'·¥?…¥·¥è·? ·¥õ·?…¢…¢…™…¥…¢ ?·¥Ä??.")
    is_admin = False
    try:
        participant = await client.get_chat_member(message.chat.id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("‡π??·¥è·? ·¥Ä?·¥?…¥·¥è·? ·¥Ä·¥Ö·?…™…¥ ?·¥Ä??, ·¥è…¥ ü ?·¥Ä·¥Ö·?…™…¥s ·¥Ñ·?…¥ ·¥õ·?…¢ ·¥ç·?·¥ç ô·??s.")
    else:
        try:
            spam_chats.remove(message.chat.id)
        except:
            pass
        return await message.reply("‡π?·¥ç·?…¥·¥õ…™·?…¥ ·¥ò Ä·¥è·?·¥áss s·¥õ·?·¥ò·?·¥á·? ‡π?)
